<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.ToggleButton?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.shape.Rectangle?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.text.Font?>
<?import java.net.URL?>

<AnchorPane fx:id="root" prefHeight="600" prefWidth="900"
    stylesheets="/com/the_pathfinders/css/dashboard.css, /com/the_pathfinders/css/tranquil_popup.css" xmlns="http://javafx.com/javafx/25"
    xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.the_pathfinders.DashboardController">
    <children>
        <!-- Background animated rectangle (fills window) -->
        <Rectangle fx:id="bgRect" AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0"
            AnchorPane.rightAnchor="0" AnchorPane.bottomAnchor="0" />

        <!-- Vignette shadow effect from left edge -->
        <Rectangle fx:id="vignetteRect" AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0"
            AnchorPane.bottomAnchor="0" width="450" mouseTransparent="true" />

        <!-- Top-left: logo -->
        <VBox AnchorPane.leftAnchor="12" AnchorPane.topAnchor="12" spacing="8" alignment="TOP_LEFT">
            <children>
                <ToggleButton fx:id="musicToggle" styleClass="music-toggle" text="Music: On" />
                <ImageView fx:id="logoImage" fitHeight="100.0" fitWidth="100.0" pickOnBounds="true"
                    preserveRatio="true" smooth="true" />
            </children>
        </VBox>

        <!-- Mood Tracker Button (Circle on left side) -->
        <AnchorPane>
            <Button fx:id="moodTrackerBtn" styleClass="mood-tracker-circle"
                    prefWidth="120" prefHeight="120"
                    AnchorPane.leftAnchor="120"
                    AnchorPane.topAnchor="300"
                    wrapText="true" text="MOOD&#10;TRACKER"/>
        </AnchorPane>

        <!-- Top-center: greeting label -->
        <Label fx:id="greetingLabel" text="Good Morning ðŸŒž" styleClass="greeting" 
            AnchorPane.topAnchor="32" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" 
            alignment="CENTER" />

        <!-- Top-right user info -->
        <HBox alignment="CENTER" spacing="8" AnchorPane.rightAnchor="12" AnchorPane.topAnchor="12">
            <Label fx:id="userLabel" alignment="CENTER_RIGHT" prefHeight="38.0" prefWidth="149.0"
                text="Logged"/>
            <ImageView fx:id="userImage" fitHeight="50.0" fitWidth="50.0" preserveRatio="true" />
        </HBox>

        <!-- Center content: greeting moved upward + draggable button cards -->
        <!-- Button cards: 3 rows Ã— 2 columns, middle row slightly indented -->
        <!-- Button cards: 3 rows Ã— 2 columns, right-aligned and slightly lower -->
        <VBox fx:id="buttonCardsBox"
            spacing="20"
            alignment="CENTER_RIGHT"
            AnchorPane.rightAnchor="100"
            AnchorPane.topAnchor="120">
            <!-- top right bottom left -->
            <children>
                <!-- Row 1 -->
                <HBox alignment="CENTER_RIGHT" spacing="16">
                    <children>
                        <Button fx:id="journalBtn" text="STRAY THOUGHTS" styleClass="card-btn"
                            prefWidth="250" prefHeight="160" wrapText="true" />
                        <Button fx:id="blogBtn" text="MIND DRIFT" styleClass="card-btn"
                            prefWidth="250" prefHeight="160" wrapText="true" />
                    </children>
                </HBox>

                <!-- Row 2 (shifted right for staggered look) -->
                <HBox alignment="CENTER_RIGHT" spacing="16" style="-fx-translate-x: 80;">
                    <children>
                        <Button fx:id="moodBtn" text="SIDEQUESTS" styleClass="card-btn"
                            prefWidth="250" prefHeight="160" wrapText="true" />
                        <Button fx:id="insightsBtn" text="SEEK HELP" styleClass="card-btn"
                            prefWidth="250" prefHeight="160" wrapText="true" />
                    </children>
                </HBox>

                <!-- Row 3 -->
                <HBox alignment="CENTER_RIGHT" spacing="16">
                    <children>
                        <Button fx:id="SocialWorkBtn" text="HOPE SEED" styleClass="card-btn"
                            prefWidth="250" prefHeight="160" wrapText="true" />
                        <Button fx:id="tranquilCornerBtn" text="TRANQUIL CORNER" styleClass="card-btn"
                            prefWidth="250" prefHeight="160" wrapText="true" />
                    </children>
                </HBox>
            </children>
        </VBox>

        <!-- User dropdown placeholder container (initially empty) -->
        <VBox fx:id="userDropdown" AnchorPane.topAnchor="60" AnchorPane.rightAnchor="12" spacing="6"
            visible="false" managed="false" />

        <!-- Journaling overlay popup (similar to profile's firstTimeOverlay) -->
        <StackPane fx:id="journalingOverlay" visible="false" managed="false"
            AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0"
            AnchorPane.bottomAnchor="0" styleClass="journaling-overlay-root">
            <children>
                <VBox fx:id="journalingContentBox" spacing="22" alignment="CENTER"
                    styleClass="journaling-popup-box">
                    <children>
                        <ImageView fx:id="journalingIcon" fitWidth="54" fitHeight="54"
                            preserveRatio="true" />
                        <Label fx:id="journalingTitle" text="Journaling"
                            styleClass="journaling-title" />
                        <Label fx:id="journalingSubtitle" text="Choose Option"
                            styleClass="journaling-subtitle" />
                        <VBox fx:id="journalingButtonsBox" spacing="14" alignment="CENTER">
                            <children>
                                <Button fx:id="createJournalBtn" text="Create Journal"
                                    styleClass="journaling-btn" prefWidth="220" prefHeight="48" />
                                <Button fx:id="viewJournalsBtn" text="View Journals"
                                    styleClass="journaling-btn" prefWidth="220" prefHeight="48" />
                            </children>
                        </VBox>
                    </children>
                </VBox>
            </children>
        </StackPane>
<!-- TRANQUIL CORNER POPUP (same as journaling, smaller height) -->
<StackPane fx:id="tranquilOverlay"
           visible="false" managed="false"
           AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0"
           AnchorPane.rightAnchor="0" AnchorPane.bottomAnchor="0"
           styleClass="journaling-overlay-root">

    <children>
        <VBox fx:id="tranquilContentBox"
              spacing="25"
              alignment="CENTER"
              styleClass="journaling-popup-box"
              prefWidth="450" prefHeight="520">

            <!-- ICON -->
            <ImageView fx:id="tranquilIcon" fitWidth="64" fitHeight="64" preserveRatio="true">
                <image>
                    <Image url="@/assets/icons/ques.png"/>
                </image>
            </ImageView>

            <!-- TITLE & SUBTITLE -->
            <Label text="ðŸŒ¸ Tranquil Corner ðŸŒ¸" styleClass="journaling-title" style="-fx-font-size: 32px;"/>
            <Label text="Choose how you'd like to relax" styleClass="journaling-subtitle" style="-fx-font-size: 16px; -fx-font-style: italic;"/>

            <!-- 3 BUTTONS IN COLUMN -->
            <VBox spacing="18" alignment="CENTER">
                <Button fx:id="meditationBtn"
                        text="âœ¨ MEDITATION âœ¨"
                        styleClass="journaling-btn"
                        prefWidth="420" prefHeight="65"
                        style="-fx-font-size: 18px; -fx-background-color: linear-gradient(to right, #E8D5F5, #F0E0FF); -fx-background-radius: 30px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 8, 0, 0, 3);"/>

                <Button fx:id="calmActivitiesBtn"
                        text="ðŸŒ¸ CALM ACTIVITIES ðŸŒ¸"
                        styleClass="journaling-btn"
                        prefWidth="420" prefHeight="65"
                        style="-fx-font-size: 18px; -fx-background-color: linear-gradient(to right, #FFE8F0, #FFF0F8); -fx-background-radius: 30px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 8, 0, 0, 3);"/>

                <Button fx:id="pomodoroBtn"
                        text="â±ï¸ POMODORO TIMER â±ï¸"
                        styleClass="journaling-btn"
                        prefWidth="420" prefHeight="65"
                        style="-fx-font-size: 18px; -fx-background-color: linear-gradient(to right, #FFE8D8, #FFF0E5); -fx-background-radius: 30px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 8, 0, 0, 3);"/>
            </VBox>

            <!-- BACK BUTTON -->
            <Button fx:id="tranquilBackBtn"
                    text="â† Back"
                    styleClass="journaling-btn"
                    prefWidth="200" prefHeight="45"
                    style="-fx-font-size: 16px; -fx-background-radius: 18px;"/>
        </VBox>
    </children>
</StackPane>

<!-- MOOD TRACKER POPUP -->
<StackPane fx:id="moodTrackerOverlay"
           visible="false" managed="false"
           AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0"
           AnchorPane.rightAnchor="0" AnchorPane.bottomAnchor="0"
           styleClass="journaling-overlay-root">
    <children>
        <VBox fx:id="moodTrackerContentBox" spacing="20" alignment="CENTER"
              styleClass="journaling-popup-box"
              prefWidth="500" maxWidth="500" prefHeight="600" maxHeight="600">

            <!-- Header -->
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Button fx:id="moodBackBtn" text="â†" styleClass="back-btn"/>
                <Label text="Mood Tracker" styleClass="journaling-title"/>
                <javafx.scene.layout.Region HBox.hgrow="ALWAYS"/>
                <Button fx:id="moodCloseBtn" text="âœ•" styleClass="close-btn"/>
            </HBox>

            <!-- Progress indicator -->
            <HBox alignment="CENTER" spacing="8">
                <javafx.scene.shape.Circle fx:id="progress1" radius="6" styleClass="progress-circle, active"/>
                <javafx.scene.shape.Circle fx:id="progress2" radius="6" styleClass="progress-circle"/>
                <javafx.scene.shape.Circle fx:id="progress3" radius="6" styleClass="progress-circle"/>
                <javafx.scene.shape.Circle fx:id="progress4" radius="6" styleClass="progress-circle"/>
                <javafx.scene.shape.Circle fx:id="progress5" radius="6" styleClass="progress-circle"/>
            </HBox>

            <!-- Scrollable questions container -->
            <ScrollPane fx:id="moodScrollPane" fitToWidth="true" hbarPolicy="NEVER"
                        VBox.vgrow="ALWAYS" styleClass="questions-scroll">
                <VBox fx:id="moodQuestionsContainer" spacing="30" style="-fx-padding: 20;"/>
            </ScrollPane>

            <!-- Navigation buttons -->
            <HBox spacing="15" alignment="CENTER">
                <Button fx:id="moodPrevBtn" text="Previous" styleClass="journaling-btn" disable="true"/>
                <Button fx:id="moodNextBtn" text="Next" styleClass="journaling-btn"/>
                <Button fx:id="moodSubmitBtn" text="Submit" styleClass="journaling-btn"
                        visible="false" managed="false"/>
            </HBox>
        </VBox>

        <!-- Results overlay (initially hidden) -->
        <VBox fx:id="moodResultsBox" spacing="25" alignment="CENTER"
              styleClass="journaling-popup-box"
              prefWidth="550" maxWidth="550" prefHeight="650" maxHeight="650"
              visible="false" managed="false">

            <Label text="Your Mood Analysis" styleClass="journaling-title"/>

            <!-- Pie chart -->
            <javafx.scene.chart.PieChart fx:id="moodPieChart" legendVisible="true"
                      prefWidth="400" prefHeight="350"/>

            <!-- Summary text -->
            <VBox spacing="10" alignment="CENTER" style="-fx-background-color: #f7fafc; -fx-background-radius: 12px; -fx-padding: 20px;">
                <Label fx:id="moodSummaryLabel" wrapText="true" alignment="CENTER"
                       maxWidth="450" style="-fx-font-size: 15px; -fx-text-fill: #4a5568;"/>
                <Label fx:id="moodScoreLabel" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #667eea;"/>
            </VBox>

            <!-- Close button -->
            <Button fx:id="moodDoneBtn" text="Done" styleClass="journaling-btn" prefWidth="150"/>
        </VBox>
    </children>
</StackPane>

    </children>
</AnchorPane>
